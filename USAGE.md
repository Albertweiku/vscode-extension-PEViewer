# PEViewer 使用指南

## 快速开始

### 1. 启动扩展开发
```bash
# 方法一：使用快捷键
按 F5 键启动扩展开发主机

# 方法二：使用命令面板
Ctrl+Shift+P -> "Debug: Start Debugging"
```

### 2. 打开PE文件
在新打开的VS Code窗口中：
1. 打开一个包含PE文件的文件夹
2. 找到.exe或.dll文件
3. 右键点击文件
4. 选择 **"Open With..."** 
5. 选择 **"PE Viewer"**

### 3. 探索PE文件结构

#### 左侧树形视图
- 📁 **PE头部** - PE文件的主要结构
  - 📂 **DOS头部** - 传统DOS头信息
  - 📂 **COFF头部** - 通用对象文件格式头
  - 📂 **可选头部** - PE特定信息
  - 📂 **区段头部** - 各个节的信息
- 📄 **导出函数** - 此PE文件导出的函数（如果有）
- 📁 **导入函数** - 依赖的DLL和函数

#### 右侧详情面板
点击树节点后显示：
- **数值字段**：同时显示十进制、十六进制、二进制
- **字符串字段**：显示内容、长度和十六进制编码
- **结构字段**：以表格形式显示所有子字段

## 界面说明

### 树形导航
```
📁 PE头部
├─ 📂 DOS头部
│  ├─ 魔数 (e_magic)
│  └─ NT头偏移 (e_lfanew)
├─ 📂 COFF头部
│  ├─ 机器类型 (Machine)
│  ├─ 节数量 (NumberOfSections)
│  ├─ 时间戳 (TimeDateStamp)
│  └─ 特性 (Characteristics)
├─ 📂 可选头部
│  ├─ 魔数 (Magic)
│  ├─ 入口点 (AddressOfEntryPoint)
│  ├─ 映像基址 (ImageBase)
│  └─ ...
└─ 📂 区段头部
   ├─ 📄 .text
   ├─ 📄 .rdata
   ├─ 📄 .data
   └─ ...
```

### 数据格式

#### 数值显示示例
| 属性 | 值 |
|------|-----|
| 十进制 | 4096 |
| 十六进制 | 0x1000 |
| 二进制 | 1000000000000 |

#### 结构显示示例
| 字段 | 值 | 十六进制 |
|------|-----|----------|
| Machine | 34404 | 0x8664 |
| NumberOfSections | 6 | 0x6 |
| AddressOfEntryPoint | 4096 | 0x1000 |

## 常见PE文件分析

### 检查架构类型
1. 点击 "可选头部"
2. 查看 "Magic" 字段：
   - `0x10B` (267) = 32位 PE文件
   - `0x20B` (523) = 64位 PE文件

### 查看入口点
1. 点击 "可选头部"
2. 查看 "AddressOfEntryPoint" - 程序开始执行的地址

### 分析依赖关系
1. 展开 "导入函数"
2. 查看所有依赖的DLL列表
3. 点击具体DLL查看导入的函数

### 查看导出函数
1. 点击 "导出函数"
2. 查看此DLL导出的所有函数（仅对DLL文件）

## 键盘快捷键

- **点击节点**：显示详细信息
- **鼠标悬停**：高亮显示
- **滚动**：浏览长列表

## 技巧与窍门

### 1. 快速识别文件类型
查看可选头部的 "Subsystem" 字段：
- `2` = GUI应用程序
- `3` = 控制台应用程序
- `1` = 驱动程序

### 2. 检查编译时间
查看COFF头部的 "TimeDateStamp" 字段，可以了解文件的编译时间

### 3. 分析节特性
在区段头部，查看 "Characteristics" 字段：
- 包含可执行代码
- 包含初始化数据
- 可读/可写/可执行权限

### 4. 理解地址
- **VirtualAddress (RVA)**：相对虚拟地址
- **PointerToRawData**：文件中的物理偏移
- **ImageBase**：加载到内存的基地址

## 故障排除

### 问题：无法打开PE文件
- 确保文件是有效的PE格式
- 检查文件权限
- 尝试使用"Open With"显式选择PEViewer

### 问题：显示信息不完整
- 某些字段可能在特定PE文件中不存在
- 导出表仅存在于DLL或有导出的EXE中

### 问题：界面响应慢
- 大型PE文件可能需要更长加载时间
- 导入函数特别多的文件需要更多处理时间

## 示例文件

可以用以下系统文件测试：

### Windows系统文件
- `C:\Windows\System32\kernel32.dll` - 核心API（有大量导出）
- `C:\Windows\System32\notepad.exe` - 简单GUI应用
- `C:\Windows\System32\calc.exe` - 计算器应用

### 注意
某些系统文件可能受保护，需要管理员权限访问。

## 下一步

- 🔍 深入学习PE文件格式
- 📚 了解Windows加载器原理
- 🛠️ 探索逆向工程工具
- 💡 贡献代码改进此扩展

---

祝您使用愉快！如有问题欢迎反馈。
